document.addEventListener("DOMContentLoaded",function(){const t=document.getElementById("mobile-menu-button"),n=document.getElementById("mobile-menu"),s=document.getElementById("search-button"),o=document.getElementById("mobile-search-button"),e=document.getElementById("search-container");t&&n&&t.addEventListener("click",function(){const e=n.classList.contains("hidden");n.classList.toggle("hidden"),t.setAttribute("aria-expanded",e?"true":"false"),t.setAttribute("title",e?"关闭菜单":"打开菜单"),t.setAttribute("aria-label",e?"关闭导航菜单":"打开导航菜单")}),s&&e&&s.addEventListener("click",function(){if(e.classList.toggle("hidden"),!e.classList.contains("hidden")){const e=document.getElementById("search-input");e&&e.focus()}}),o&&e&&o.addEventListener("click",function(){if(e.classList.toggle("hidden"),!e.classList.contains("hidden")){const e=document.getElementById("search-input");e&&e.focus()}});const i=document.getElementById("search-form");if(i&&i.addEventListener("submit",function(e){e.preventDefault();const t=document.getElementById("search-input");if(t&&t.value.trim()){const e=encodeURIComponent(t.value+" site:"+window.location.hostname);window.open("https://www.google.com/search?q="+e,"_blank")}}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();const t=document.querySelector(this.getAttribute("href"));t&&t.scrollIntoView({behavior:"smooth",block:"start"})})}),document.querySelectorAll(".news-card").forEach(e=>{e.addEventListener("mouseenter",function(){this.style.transform="translateY(-5px)"}),e.addEventListener("mouseleave",function(){this.style.transform="translateY(0)"})}),"IntersectionObserver"in window){const e=new IntersectionObserver((t)=>{t.forEach(t=>{if(t.isIntersecting){const n=t.target;n.src=n.dataset.src,n.classList.remove("lazy"),e.unobserve(n)}})});document.querySelectorAll("img[data-src]").forEach(t=>{e.observe(t)})}document.querySelectorAll("img").forEach(e=>{e.addEventListener("error",function(){this.dataset.fallbackApplied||(this.dataset.fallbackApplied="true",this.src="https://via.placeholder.com/400x200.png/3B82F6/FFFFFF?text=图片加载失败",this.alt="图片加载失败")})});const a=document.querySelectorAll(".loading");a.forEach(e=>{setTimeout(()=>{e.classList.add("loaded")},100)}),window.addEventListener("load",function(){document.body.classList.add("page-loaded")})}),window.addEventListener("scroll",function(){const t=window.pageYOffset||document.documentElement.scrollTop,e=document.getElementById("back-to-top");e&&(t>300?(e.style.display="block",e.style.opacity="1"):(e.style.opacity="0",setTimeout(()=>{e.style.opacity==="0"&&(e.style.display="none")},300)))}),document.addEventListener("DOMContentLoaded",function(){const e=document.createElement("button");e.id="back-to-top",e.innerHTML="↑",e.className="fixed bottom-6 right-6 bg-primary-blue text-white w-12 h-12 rounded-full shadow-lg hover:bg-blue-800 transition-all duration-300 z-50",e.style.display="none",e.style.opacity="0",e.addEventListener("click",function(){window.scrollTo({top:0,behavior:"smooth"})}),document.body.appendChild(e)});function shareToWeChat(){copyToClipboard(),alert("链接已复制到剪贴板，请在微信中粘贴分享")}function shareToWeibo(){const e=document.title,t=encodeURIComponent(window.location.href),n=encodeURIComponent(e);window.open(`https://service.weibo.com/share/share.php?url=${t}&title=${n}`,"_blank","width=600,height=400")}function copyToClipboard(){const e=window.location.href;if(navigator.clipboard)navigator.clipboard.writeText(e).then(()=>{showNotification("链接已复制到剪贴板")});else{const t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t),showNotification("链接已复制到剪贴板")}}function showNotification(e){const t=document.createElement("div");t.className="fixed top-4 right-4 bg-primary-blue text-white px-4 py-2 rounded-lg shadow-lg z-50 transform translate-x-full transition-transform duration-300",t.textContent=e,document.body.appendChild(t),setTimeout(()=>{t.style.transform="translateX(0)"},100),setTimeout(()=>{t.style.transform="translateX(full)",setTimeout(()=>{document.body.removeChild(t)},300)},3e3)}document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("application-form-submit");e&&e.addEventListener("submit",function(e){e.preventDefault();const s=new FormData(this),t={};for(let[e,n]of s.entries())t[e]=n;const o=["name","gender","student_id","major","grade","phone","email","department","reason"],i=o.filter(e=>!t[e]||t[e].trim()==="");if(i.length>0){showNotification("请填写所有必填项！","error");return}if(!t.agree_terms){showNotification("请同意相关条款！","error");return}const n=this.querySelector('button[type="submit"]'),a=n.innerHTML;n.innerHTML='<div class="animate-spin inline-block w-4 h-4 border-2 border-white border-t-transparent rounded-full mr-2"></div>提交中...',n.disabled=!0,setTimeout(()=>{const e=JSON.parse(localStorage.getItem("applications")||"[]");e.push({...t,timestamp:(new Date).toISOString(),id:Date.now()}),localStorage.setItem("applications",JSON.stringify(e)),showNotification("申请提交成功！我们会尽快联系您。","success"),this.reset(),n.innerHTML=a,n.disabled=!1},2e3)})}),document.addEventListener("DOMContentLoaded",function(){const t=document.getElementById("comment-form"),e=document.getElementById("comments-list");t&&e&&(n(),t.addEventListener("submit",function(e){e.preventDefault();const t=new FormData(this),s={name:t.get("comment_name"),email:t.get("comment_email"),content:t.get("comment_content"),timestamp:(new Date).toISOString(),id:Date.now(),approved:!1};if(!s.name||!s.content){showNotification("请填写姓名和评论内容！","error");return}const o=window.location.pathname,i=JSON.parse(localStorage.getItem(`comments_${o}`)||"[]");i.push(s),localStorage.setItem(`comments_${o}`,JSON.stringify(i)),showNotification("评论提交成功！将在审核后显示。","success"),this.reset(),n()}));function n(){if(!e)return;const n=window.location.pathname,s=JSON.parse(localStorage.getItem(`comments_${n}`)||"[]"),t=s.filter(e=>e.approved);t.length===0?e.innerHTML=`
                <div class="text-center text-gray-500 py-8">
                    <svg class="w-12 h-12 mx-auto mb-4 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
                    </svg>
                    <p>暂无评论，快来抢沙发吧！</p>
                </div>
            `:e.innerHTML=t.map(e=>`
                <div class="bg-white rounded-lg p-6 mb-4 border border-gray-200">
                    <div class="flex items-center mb-3">
                        <div class="w-10 h-10 bg-primary-blue rounded-full flex items-center justify-center text-white font-bold mr-3">
                            ${e.name.charAt(0).toUpperCase()}
                        </div>
                        <div>
                            <div class="font-medium text-gray-800">${e.name}</div>
                            <div class="text-sm text-gray-500">${new Date(e.timestamp).toLocaleString("zh-CN")}</div>
                        </div>
                    </div>
                    <div class="text-gray-700 leading-relaxed">${e.content}</div>
                </div>
            `).join("")}});function showNotification(e,t="info"){const n=document.createElement("div"),s={success:"bg-green-500",error:"bg-red-500",info:"bg-primary-blue",warning:"bg-yellow-500"};n.className=`fixed top-4 right-4 ${s[t]} text-white px-6 py-3 rounded-lg shadow-lg z-50 transform translate-x-full transition-transform duration-300 max-w-sm`,n.innerHTML=`
        <div class="flex items-center">
            <div class="mr-3">
                ${t==="success"?"✓":t==="error"?"✕":t==="warning"?"⚠":"ℹ"}
            </div>
            <div class="flex-1">${e}</div>
        </div>
    `,document.body.appendChild(n),setTimeout(()=>{n.style.transform="translateX(0)"},100),setTimeout(()=>{n.style.transform="translateX(100%)",setTimeout(()=>{document.body.removeChild(n)},300)},4e3)}
<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>记者团内容管理系统</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
      margin: 0;
      padding: 20px;
      background-color: #f5f5f5;
    }
    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: white;
      border-radius: 8px;
      padding: 30px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    h1 {
      color: #333;
      text-align: center;
      margin-bottom: 30px;
    }
    .news-section {
      margin-bottom: 40px;
    }
    .news-item {
      border: 1px solid #ddd;
      border-radius: 6px;
      padding: 20px;
      margin-bottom: 15px;
      background: #fafafa;
    }
    .news-title {
      font-size: 18px;
      font-weight: bold;
      color: #2c5aa0;
      margin-bottom: 10px;
    }
    .news-date {
      color: #666;
      font-size: 14px;
      margin-bottom: 10px;
    }
    .news-desc {
      color: #555;
      line-height: 1.5;
    }
    .add-btn {
      background-color: #2c5aa0;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 16px;
      margin-bottom: 20px;
    }
    .add-btn:hover {
      background-color: #1e3f73;
    }
    .form-group {
      margin-bottom: 20px;
    }
    .form-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
      color: #333;
    }
    .form-group input, .form-group textarea, .form-group select {
      width: 100%;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 14px;
    }
    .form-group textarea {
      height: 200px;
      resize: vertical;
    }
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.5);
      z-index: 1000;
    }
    .modal-content {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: white;
      padding: 30px;
      border-radius: 8px;
      width: 90%;
      max-width: 600px;
      max-height: 80vh;
      overflow-y: auto;
    }
    .btn-group {
      text-align: right;
      margin-top: 20px;
    }
    .btn {
      padding: 10px 20px;
      margin-left: 10px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
    }
    .btn-primary {
      background-color: #2c5aa0;
      color: white;
    }
    .btn-secondary {
      background-color: #6c757d;
      color: white;
    }
    .tab-navigation {
      display: flex;
      border-bottom: 2px solid #ddd;
      margin-bottom: 30px;
    }
    .tab-btn {
      background: none;
      border: none;
      padding: 15px 25px;
      cursor: pointer;
      font-size: 16px;
      font-weight: bold;
      color: #666;
      border-bottom: 3px solid transparent;
      transition: all 0.3s ease;
    }
    .tab-btn.active {
      color: #2c5aa0;
      border-bottom-color: #2c5aa0;
    }
    .tab-content {
      display: none;
    }
    .tab-content.active {
      display: block;
    }
    .dept-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin-bottom: 20px;
    }
    .dept-item {
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 20px;
      background: #f9f9f9;
    }
    .dept-header {
      display: flex;
      align-items: center;
      margin-bottom: 15px;
    }
    .dept-icon {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-right: 15px;
      color: white;
    }
    .dept-name {
      font-size: 18px;
      font-weight: bold;
      margin-bottom: 5px;
    }
    .member-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 20px;
    }
    .member-item {
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 20px;
      background: #f9f9f9;
      text-align: center;
    }
    .member-avatar-mini {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      margin: 0 auto 15px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
    }
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 20px;
    }
    .stat-item {
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 20px;
      background: #f9f9f9;
      text-align: center;
    }
    .stat-number {
      font-size: 36px;
      font-weight: bold;
      color: #2c5aa0;
      margin-bottom: 10px;
    }
    .form-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
    }
    .md-btn {
      background: #f8f9fa;
      border: 1px solid #dee2e6;
      padding: 5px 10px;
      margin-right: 5px;
      margin-bottom: 5px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 12px;
      transition: background-color 0.2s;
    }
    .md-btn:hover {
      background: #e9ecef;
    }
    .article-item {
      position: relative;
      padding: 20px;
      margin-bottom: 15px;
      border: 1px solid #ddd;
      border-radius: 8px;
      background: #fafafa;
      overflow: hidden;
    }
    .article-cover {
      width: 120px;
      height: 80px;
      object-fit: cover;
      border-radius: 6px;
      float: right;
      margin-left: 15px;
      border: 1px solid #ddd;
    }
    .article-content {
      overflow: hidden;
    }
    .article-no-cover {
      width: 100%;
    }
  </style>
</head>
<body>
  <div class="container">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
      <h1>📰 六盘水师范学院计算机科学学院记者团 - 内容管理系统</h1>
      <div style="display: flex; align-items: center; gap: 15px;">
        <span id="welcomeText" style="color: #666; font-size: 14px;"></span>
        <button onclick="logout()" style="background: #dc3545; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; font-size: 14px;">退出登录</button>
      </div>
    </div>
    
    <!-- 标签页导航 -->
    <div class="tab-navigation">
      <button class="tab-btn active" onclick="switchTab('news')">📰 新闻文章管理</button>
      <button class="tab-btn" onclick="switchTab('team')">👥 记者团风采管理</button>
    </div>
    
    <!-- 新闻文章管理 -->
    <div id="news-tab" class="tab-content active">
      <div class="news-section">
        <h2>新闻文章管理</h2>
        <button class="add-btn" onclick="openAddModal()">+ 添加新文章</button>
        <div id="newsList">
          <!-- 现有文章将在这里显示 -->
        </div>
      </div>
    </div>
    
    <!-- 记者团风采管理 -->
    <div id="team-tab" class="tab-content">
      <div class="news-section">
        <h2>组织架构管理</h2>
        <button class="add-btn" onclick="openDeptModal()">✏️ 编辑部门信息</button>
        <div id="deptList" class="dept-grid">
          <!-- 部门信息将在这里显示 -->
        </div>
      </div>
      
      <div class="news-section">
        <h2>优秀成员管理</h2>
        <button class="add-btn" onclick="openMemberModal()">👤 编辑成员信息</button>
        <div id="memberList" class="member-grid">
          <!-- 优秀成员将在这里显示 -->
        </div>
      </div>
      
      <div class="news-section">
        <h2>团队数据管理</h2>
        <button class="add-btn" onclick="openStatsModal()">📊 编辑统计数据</button>
        <div id="statsList" class="stats-grid">
          <!-- 团队数据将在这里显示 -->
        </div>
      </div>
    </div>
  </div>

  <!-- 添加/编辑文章的模态框 -->
  <div id="articleModal" class="modal">
    <div class="modal-content">
      <h3 id="modalTitle">添加新文章</h3>
      <form id="articleForm">
        <div class="form-group">
          <label for="title">标题 *</label>
          <input type="text" id="title" required>
        </div>
        <div class="form-group">
          <label for="date">发布日期 *</label>
          <input type="datetime-local" id="date" required>
        </div>
        <div class="form-group">
          <label for="description">简短描述 *</label>
          <input type="text" id="description" required>
        </div>
        <div class="form-group">
          <label for="categories">分类</label>
          <select id="categories">
            <option value="校园要闻">校园要闻</option>
            <option value="教学科研">教学科研</option>
            <option value="团学活动">团学活动</option>
          </select>
        </div>
        <div class="form-group">
          <label for="tags">标签 (用逗号分隔)</label>
          <input type="text" id="tags" placeholder="例如: 学术讲座, 人工智能">
        </div>
        <div class="form-group">
          <label for="cover">文章封面</label>
          <input type="file" id="cover" accept="image/*" onchange="handleCoverUpload(event)">
          <div id="coverPreview" style="margin-top: 10px; display: none;">
            <img id="coverImage" style="max-width: 200px; max-height: 150px; border-radius: 8px; border: 1px solid #ddd;">
            <button type="button" onclick="removeCover()" style="margin-left: 10px; background: #dc3545; color: white; border: none; padding: 5px 10px; border-radius: 4px; cursor: pointer;">移除封面</button>
          </div>
        </div>
        <div class="form-group">
          <label for="body">文章内容 (Markdown格式) *</label>
          <div style="margin-bottom: 10px;">
            <button type="button" onclick="insertMarkdown('**粗体**')" class="md-btn">粗体</button>
            <button type="button" onclick="insertMarkdown('*斜体*')" class="md-btn">斜体</button>
            <button type="button" onclick="insertMarkdown('# 标题')" class="md-btn">标题</button>
            <button type="button" onclick="insertMarkdown('- 列表项')" class="md-btn">列表</button>
            <button type="button" onclick="insertMarkdown('[链接文字](URL)')" class="md-btn">链接</button>
            <input type="file" id="imageUpload" accept="image/*" onchange="handleImageUpload(event)" style="display: none;">
            <button type="button" onclick="document.getElementById('imageUpload').click()" class="md-btn">📷 插入图片</button>
          </div>
          <textarea id="body" required placeholder="请输入Markdown格式的文章内容...

示例语法：
# 标题
## 二级标题
**粗体文字**
*斜体文字*
- 列表项
[链接文字](链接地址)
![图片描述](图片地址)

您也可以使用上方的工具栏快速插入格式。"></textarea>
          <div style="margin-top: 10px;">
            <label>
              <input type="checkbox" id="previewMode" onchange="togglePreview()">
              实时预览
            </label>
          </div>
          <div id="markdownPreview" style="display: none; margin-top: 15px; padding: 15px; border: 1px solid #ddd; border-radius: 8px; background: #f9f9f9; max-height: 300px; overflow-y: auto;"></div>
        </div>
        <div class="btn-group">
          <button type="button" class="btn btn-secondary" onclick="closeModal()">取消</button>
          <button type="submit" class="btn btn-primary">保存文章</button>
        </div>
      </form>
    </div>
  </div>

  <!-- 编辑部门信息的模态框 -->
  <div id="deptModal" class="modal">
    <div class="modal-content">
      <h3>编辑组织架构信息</h3>
      <form id="deptForm">
        <h4>新闻部</h4>
        <div class="form-row">
          <div class="form-group">
            <label for="news_leader">部长姓名</label>
            <input type="text" id="news_leader" value="张同学">
          </div>
          <div class="form-group">
            <label for="news_vice_leader">副部长姓名</label>
            <input type="text" id="news_vice_leader" value="李同学">
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label for="news_members">成员数量</label>
            <input type="number" id="news_members" value="12">
          </div>
          <div class="form-group">
            <label for="news_desc">部门描述</label>
            <input type="text" id="news_desc" value="负责新闻采写、采访报道等核心新闻业务工作">
          </div>
        </div>
        
        <h4>摄影部</h4>
        <div class="form-row">
          <div class="form-group">
            <label for="photo_leader">部长姓名</label>
            <input type="text" id="photo_leader" value="王同学">
          </div>
          <div class="form-group">
            <label for="photo_vice_leader">副部长姓名</label>
            <input type="text" id="photo_vice_leader" value="刘同学">
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label for="photo_members">成员数量</label>
            <input type="number" id="photo_members" value="10">
          </div>
          <div class="form-group">
            <label for="photo_desc">部门描述</label>
            <input type="text" id="photo_desc" value="负责校园活动摄影记录、图片新闻制作">
          </div>
        </div>
        
        <h4>编辑部</h4>
        <div class="form-row">
          <div class="form-group">
            <label for="edit_leader">部长姓名</label>
            <input type="text" id="edit_leader" value="孙同学">
          </div>
          <div class="form-group">
            <label for="edit_vice_leader">副部长姓名</label>
            <input type="text" id="edit_vice_leader" value="周同学">
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label for="edit_members">成员数量</label>
            <input type="number" id="edit_members" value="8">
          </div>
          <div class="form-group">
            <label for="edit_desc">部门描述</label>
            <input type="text" id="edit_desc" value="负责稿件编辑、校对、排版等后期制作工作">
          </div>
        </div>
        
        <h4>策划部</h4>
        <div class="form-row">
          <div class="form-group">
            <label for="plan_leader">部长姓名</label>
            <input type="text" id="plan_leader" value="吴同学">
          </div>
          <div class="form-group">
            <label for="plan_vice_leader">副部长姓名</label>
            <input type="text" id="plan_vice_leader" value="郑同学">
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label for="plan_members">成员数量</label>
            <input type="number" id="plan_members" value="6">
          </div>
          <div class="form-group">
            <label for="plan_desc">部门描述</label>
            <input type="text" id="plan_desc" value="负责活动策划、专题制作、创意内容等策划工作">
          </div>
        </div>
        
        <div class="btn-group">
          <button type="button" class="btn btn-secondary" onclick="closeDeptModal()">取消</button>
          <button type="submit" class="btn btn-primary">保存更改</button>
        </div>
      </form>
    </div>
  </div>

  <!-- 编辑优秀成员的模态框 -->
  <div id="memberModal" class="modal">
    <div class="modal-content">
      <h3>编辑优秀成员信息</h3>
      <form id="memberForm">
        <h4>张同学 (新闻部部长)</h4>
        <div class="form-row">
          <div class="form-group">
            <label for="member1_name">姓名</label>
            <input type="text" id="member1_name" value="张同学">
          </div>
          <div class="form-group">
            <label for="member1_position">职位</label>
            <input type="text" id="member1_position" value="新闻部部长">
          </div>
        </div>
        <div class="form-group">
          <label for="member1_desc">个人描述</label>
          <textarea id="member1_desc">新闻学专业，擅长深度报道和人物专访，曾获校级新闻作品一等奖。</textarea>
        </div>
        <div class="form-group">
          <label for="member1_tag">标签</label>
          <input type="text" id="member1_tag" value="🏆 新闻作品一等奖">
        </div>
        
        <h4>李同学 (摄影部部长)</h4>
        <div class="form-row">
          <div class="form-group">
            <label for="member2_name">姓名</label>
            <input type="text" id="member2_name" value="李同学">
          </div>
          <div class="form-group">
            <label for="member2_position">职位</label>
            <input type="text" id="member2_position" value="摄影部部长">
          </div>
        </div>
        <div class="form-group">
          <label for="member2_desc">个人描述</label>
          <textarea id="member2_desc">计算机学院学生，热爱摄影，作品多次在校园摄影比赛中获奖。</textarea>
        </div>
        <div class="form-group">
          <label for="member2_tag">标签</label>
          <input type="text" id="member2_tag" value="📸 摄影比赛获奖">
        </div>
        
        <h4>王同学 (编辑部部长)</h4>
        <div class="form-row">
          <div class="form-group">
            <label for="member3_name">姓名</label>
            <input type="text" id="member3_name" value="王同学">
          </div>
          <div class="form-group">
            <label for="member3_position">职位</label>
            <input type="text" id="member3_position" value="编辑部部长">
          </div>
        </div>
        <div class="form-group">
          <label for="member3_desc">个人描述</label>
          <textarea id="member3_desc">传媒学院学生，精通文字编辑和排版设计，作品编辑规范。</textarea>
        </div>
        <div class="form-group">
          <label for="member3_tag">标签</label>
          <input type="text" id="member3_tag" value="✏️ 编辑能手">
        </div>
        
        <h4>陈同学 (策划部部长)</h4>
        <div class="form-row">
          <div class="form-group">
            <label for="member4_name">姓名</label>
            <input type="text" id="member4_name" value="陈同学">
          </div>
          <div class="form-group">
            <label for="member4_position">职位</label>
            <input type="text" id="member4_position" value="策划部部长">
          </div>
        </div>
        <div class="form-group">
          <label for="member4_desc">个人描述</label>
          <textarea id="member4_desc">市场营销专业，富有创意思维，擅长活动策划和专题制作。</textarea>
        </div>
        <div class="form-group">
          <label for="member4_tag">标签</label>
          <input type="text" id="member4_tag" value="💡 创意策划师">
        </div>
        
        <div class="btn-group">
          <button type="button" class="btn btn-secondary" onclick="closeMemberModal()">取消</button>
          <button type="submit" class="btn btn-primary">保存更改</button>
        </div>
      </form>
    </div>
  </div>

  <!-- 编辑团队数据的模态框 -->
  <div id="statsModal" class="modal">
    <div class="modal-content">
      <h3>编辑团队统计数据</h3>
      <form id="statsForm">
        <div class="form-row">
          <div class="form-group">
            <label for="team_members">团队成员数</label>
            <input type="number" id="team_members" value="36">
          </div>
          <div class="form-group">
            <label for="news_reports">新闻报道数</label>
            <input type="text" id="news_reports" value="200+">
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label for="awards">获奖作品数</label>
            <input type="text" id="awards" value="50+">
          </div>
          <div class="form-group">
            <label for="years">年度历程</label>
            <input type="number" id="years" value="5">
          </div>
        </div>
        
        <div class="btn-group">
          <button type="button" class="btn btn-secondary" onclick="closeStatsModal()">取消</button>
          <button type="submit" class="btn btn-primary">保存更改</button>
        </div>
      </form>
    </div>
  </div>

  <script>
    // 简单的文章管理系统
    let articles = [];
    let currentEditIndex = -1;

    // 简单的Markdown解析器
    function parseMarkdown(text) {
      if (!text) return '';
      
      return text
        // 标题
        .replace(/^### (.*$)/gim, '<h3>$1</h3>')
        .replace(/^## (.*$)/gim, '<h2>$1</h2>')
        .replace(/^# (.*$)/gim, '<h1>$1</h1>')
        // 粗体和斜体
        .replace(/\*\*(.*)\*\*/gim, '<strong>$1</strong>')
        .replace(/\*(.*)\*/gim, '<em>$1</em>')
        // 链接
        .replace(/\[([^\]]*)\]\(([^\)]*)\)/gim, '<a href="$2" target="_blank">$1</a>')
        // 图片
        .replace(/!\[([^\]]*)\]\(([^\)]*)\)/gim, '<img src="$2" alt="$1" style="max-width: 100%; height: auto; border-radius: 4px; margin: 10px 0;">')
        // 列表
        .replace(/^\s*\n\*/gm, '\n•')
        .replace(/^\* (.+)/gim, '<li>$1</li>')
        .replace(/(<li>.*<\/li>)/s, '<ul>$1</ul>')
        // 代码块
        .replace(/`([^`]*)`/gim, '<code style="background: #f4f4f4; padding: 2px 6px; border-radius: 3px; font-family: monospace;">$1</code>')
        // 换行
        .replace(/\n/gim, '<br>');
    }

    // Markdown工具栏功能
    function insertMarkdown(syntax) {
      const textarea = document.getElementById('body');
      const start = textarea.selectionStart;
      const end = textarea.selectionEnd;
      const selectedText = textarea.value.substring(start, end);
      
      let newText;
      if (syntax === '**粗体**' && selectedText) {
        newText = `**${selectedText}**`;
      } else if (syntax === '*斜体*' && selectedText) {
        newText = `*${selectedText}*`;
      } else if (syntax === '# 标题' && selectedText) {
        newText = `# ${selectedText}`;
      } else {
        newText = syntax;
      }
      
      textarea.value = textarea.value.substring(0, start) + newText + textarea.value.substring(end);
      textarea.focus();
      
      // 更新预览
      if (document.getElementById('previewMode').checked) {
        updateMarkdownPreview();
      }
    }

    // 切换预览模式
    function togglePreview() {
      const previewDiv = document.getElementById('markdownPreview');
      const isChecked = document.getElementById('previewMode').checked;
      
      if (isChecked) {
        previewDiv.style.display = 'block';
        updateMarkdownPreview();
        // 监听输入变化
        document.getElementById('body').addEventListener('input', updateMarkdownPreview);
      } else {
        previewDiv.style.display = 'none';
        document.getElementById('body').removeEventListener('input', updateMarkdownPreview);
      }
    }

    // 更新Markdown预览
    function updateMarkdownPreview() {
      const markdown = document.getElementById('body').value;
      const html = parseMarkdown(markdown);
      document.getElementById('markdownPreview').innerHTML = html;
    }

    // 处理图片上传
    function handleImageUpload(event) {
      const file = event.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
          const imageUrl = e.target.result;
          const imageName = file.name;
          const markdownImg = `![${imageName}](${imageUrl})`;
          
          // 插入到光标位置
          const textarea = document.getElementById('body');
          const start = textarea.selectionStart;
          const end = textarea.selectionEnd;
          textarea.value = textarea.value.substring(0, start) + markdownImg + textarea.value.substring(end);
          
          // 更新预览
          if (document.getElementById('previewMode').checked) {
            updateMarkdownPreview();
          }
          
          alert('图片已插入到文章中！');
        };
        reader.readAsDataURL(file);
      }
    }

    // 处理封面上传
    function handleCoverUpload(event) {
      const file = event.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
          const coverImage = document.getElementById('coverImage');
          const coverPreview = document.getElementById('coverPreview');
          
          coverImage.src = e.target.result;
          coverPreview.style.display = 'block';
        };
        reader.readAsDataURL(file);
      }
    }

    // 移除封面
    function removeCover() {
      document.getElementById('cover').value = '';
      document.getElementById('coverPreview').style.display = 'none';
      document.getElementById('coverImage').src = '';
    }

    // 记者团风采数据
    let teamData = {
      departments: {
        news: { name: '新闻部', englishName: 'News Department', leader: '张同学', viceLeader: '李同学', members: 12, description: '负责新闻采写、采访报道等核心新闻业务工作' },
        photo: { name: '摄影部', englishName: 'Photography Department', leader: '王同学', viceLeader: '刘同学', members: 10, description: '负责校园活动摄影记录、图片新闻制作' },
        edit: { name: '编辑部', englishName: 'Editorial Department', leader: '孙同学', viceLeader: '周同学', members: 8, description: '负责稿件编辑、校对、排版等后期制作工作' },
        plan: { name: '策划部', englishName: 'Planning Department', leader: '吴同学', viceLeader: '郑同学', members: 6, description: '负责活动策划、专题制作、创意内容等策划工作' }
      },
      members: {
        member1: { name: '张同学', position: '新闻部部长', description: '新闻学专业，擅长深度报道和人物专访，曾获校级新闻作品一等奖。', tag: '🏆 新闻作品一等奖', color: 'blue' },
        member2: { name: '李同学', position: '摄影部部长', description: '计算机学院学生，热爱摄影，作品多次在校园摄影比赛中获奖。', tag: '📸 摄影比赛获奖', color: 'green' },
        member3: { name: '王同学', position: '编辑部部长', description: '传媒学院学生，精通文字编辑和排版设计，作品编辑规范。', tag: '✏️ 编辑能手', color: 'purple' },
        member4: { name: '陈同学', position: '策划部部长', description: '市场营销专业，富有创意思维，擅长活动策划和专题制作。', tag: '💡 创意策划师', color: 'orange' }
      },
      stats: {
        teamMembers: 36,
        newsReports: '200+',
        awards: '50+',
        years: 5
      }
    };

    // 加载现有文章 (模拟)
    function loadExistingArticles() {
      // 这里可以加载现有的文章数据
      articles = [
        {
          title: "示例文章：人工智能技术讲座成功举办",
          date: "2025-01-15T14:00",
          description: "我院成功举办人工智能前沿技术专题讲座",
          categories: "教学科研",
          tags: ["人工智能", "学术讲座"],
          cover: "", // 封面图片URL
          body: `# 人工智能前沿技术专题讲座成功举办

**时间**：2025年1月15日下午14:00  
**地点**：学术报告厅  
**主题**：人工智能前沿技术与应用

![讲座现场](/images/banners/banner4.jpg)

## 讲座概况

我院于2025年1月15日下午在学术报告厅成功举办了人工智能前沿技术专题讲座。本次讲座特邀业界知名专家，为师生们带来了一场精彩的学术盛宴。

## 主要内容

- **机器学习算法**的最新发展
- **深度神经网络**在实际应用中的突破
- **自然语言处理**技术的未来展望
- **计算机视觉**领域的创新应用

## 参与情况

本次讲座吸引了来自计算机科学学院、数学学院等多个学院的师生参与，现场座无虚席。

*感谢所有参与者的热情支持！*`
        }
      ];
      renderArticles();
    }

    // 渲染文章列表
    function renderArticles() {
      const container = document.getElementById('newsList');
      if (articles.length === 0) {
        container.innerHTML = '<p style="text-align: center; color: #666;">暂无文章，点击上方按钮添加第一篇文章。</p>';
        return;
      }

      container.innerHTML = articles.map((article, index) => {
        const hasCover = article.cover && article.cover.trim() !== '';
        
        return `
        <div class="article-item ${hasCover ? '' : 'article-no-cover'}">
          ${hasCover ? `<img src="${article.cover}" alt="文章封面" class="article-cover">` : ''}
          <div class="article-content">
            <div class="news-title" style="font-size: 18px; font-weight: bold; color: #2c5aa0; margin-bottom: 8px;">${article.title}</div>
            <div class="news-date" style="color: #666; font-size: 14px; margin-bottom: 8px;">
              📅 ${formatDate(article.date)} | 📂 ${article.categories}
              ${hasCover ? ' | 🖼️ 有封面' : ' | 📄 无封面'}
            </div>
            <div class="news-desc" style="color: #555; line-height: 1.4; margin-bottom: 10px;">${article.description}</div>
            <div style="margin-bottom: 10px;">
              ${article.tags.map(tag => `<span style="background: #e9ecef; color: #495057; padding: 2px 6px; border-radius: 12px; font-size: 12px; margin-right: 5px;">#${tag}</span>`).join('')}
            </div>
            <div style="margin-top: 15px; clear: both;">
              <button onclick="editArticle(${index})" style="background: #28a745; color: white; border: none; padding: 8px 15px; border-radius: 4px; margin-right: 10px; cursor: pointer; font-size: 14px;">✏️ 编辑</button>
              <button onclick="previewArticle(${index})" style="background: #17a2b8; color: white; border: none; padding: 8px 15px; border-radius: 4px; margin-right: 10px; cursor: pointer; font-size: 14px;">👁️ 预览</button>
              <button onclick="deleteArticle(${index})" style="background: #dc3545; color: white; border: none; padding: 8px 15px; border-radius: 4px; cursor: pointer; font-size: 14px;">🗑️ 删除</button>
            </div>
          </div>
        </div>
      `;
      }).join('');
    }

    // 格式化日期
    function formatDate(dateStr) {
      const date = new Date(dateStr);
      return date.toLocaleString('zh-CN');
    }

    // 打开添加文章模态框
    function openAddModal() {
      currentEditIndex = -1;
      document.getElementById('modalTitle').textContent = '添加新文章';
      document.getElementById('articleForm').reset();
      document.getElementById('date').value = new Date().toISOString().slice(0,16);
      
      // 清理封面预览
      document.getElementById('coverPreview').style.display = 'none';
      document.getElementById('coverImage').src = '';
      
      // 清理Markdown预览
      document.getElementById('previewMode').checked = false;
      document.getElementById('markdownPreview').style.display = 'none';
      
      document.getElementById('articleModal').style.display = 'block';
    }

    // 预览文章
    function previewArticle(index) {
      const article = articles[index];
      const previewWindow = window.open('', '_blank', 'width=800,height=600,scrollbars=yes');
      
      const previewContent = `
        <!DOCTYPE html>
        <html>
        <head>
          <meta charset="utf-8">
          <title>${article.title}</title>
          <style>
            body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; line-height: 1.6; }
            .cover { width: 100%; max-height: 300px; object-fit: cover; border-radius: 8px; margin-bottom: 20px; }
            .meta { color: #666; font-size: 14px; margin-bottom: 20px; }
            .content { color: #333; }
            h1 { color: #333; }
            h2 { color: #555; border-bottom: 1px solid #eee; padding-bottom: 10px; }
            h3 { color: #666; }
            img { max-width: 100%; height: auto; }
            code { background: #f4f4f4; padding: 2px 6px; border-radius: 3px; }
            .tag { background: #e9ecef; color: #495057; padding: 3px 8px; border-radius: 12px; font-size: 12px; margin-right: 5px; }
          </style>
        </head>
        <body>
          <h1>${article.title}</h1>
          <div class="meta">
            📅 ${formatDate(article.date)} | 📂 ${article.categories} | 
            ${article.tags.map(tag => `<span class="tag">#${tag}</span>`).join('')}
          </div>
          ${article.cover ? `<img src="${article.cover}" alt="文章封面" class="cover">` : ''}
          <div class="content">
            ${parseMarkdown(article.body)}
          </div>
        </body>
        </html>
      `;
      
      previewWindow.document.write(previewContent);
      previewWindow.document.close();
    }

    // 编辑文章
    function editArticle(index) {
      currentEditIndex = index;
      const article = articles[index];
      document.getElementById('modalTitle').textContent = '编辑文章';
      document.getElementById('title').value = article.title;
      document.getElementById('date').value = article.date;
      document.getElementById('description').value = article.description;
      document.getElementById('categories').value = article.categories;
      document.getElementById('tags').value = article.tags.join(', ');
      document.getElementById('body').value = article.body;
      
      // 处理封面
      if (article.cover && article.cover.trim() !== '') {
        document.getElementById('coverImage').src = article.cover;
        document.getElementById('coverPreview').style.display = 'block';
      } else {
        document.getElementById('coverPreview').style.display = 'none';
      }
      
      document.getElementById('articleModal').style.display = 'block';
    }

    // 删除文章
    function deleteArticle(index) {
      if (confirm('确定要删除这篇文章吗？')) {
        articles.splice(index, 1);
        renderArticles();
        alert('文章已删除！');
      }
    }

    // 关闭模态框
    function closeModal() {
      document.getElementById('articleModal').style.display = 'none';
    }

    // 保存文章
    document.getElementById('articleForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const coverImage = document.getElementById('coverImage');
      const article = {
        title: document.getElementById('title').value,
        date: document.getElementById('date').value,
        description: document.getElementById('description').value,
        categories: document.getElementById('categories').value,
        tags: document.getElementById('tags').value.split(',').map(tag => tag.trim()).filter(tag => tag),
        cover: coverImage.src || '', // 保存封面图片
        body: document.getElementById('body').value
      };

      if (currentEditIndex >= 0) {
        articles[currentEditIndex] = article;
        alert('文章已更新！');
      } else {
        articles.push(article);
        alert('文章已添加！');
      }

      renderArticles();
      closeModal();
    });

    // 点击模态框外部关闭
    document.getElementById('articleModal').addEventListener('click', function(e) {
      if (e.target === this) {
        closeModal();
      }
    });

    // 标签页切换
    function switchTab(tabName) {
      // 移除所有活动状态
      document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
      document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
      
      // 激活选中的标签页
      event.target.classList.add('active');
      document.getElementById(tabName + '-tab').classList.add('active');
      
      if (tabName === 'team') {
        renderTeamData();
      }
    }

    // 渲染记者团风采数据
    function renderTeamData() {
      renderDepartments();
      renderMembers();
      renderStats();
    }

    // 渲染部门信息
    function renderDepartments() {
      const container = document.getElementById('deptList');
      const deptIcons = {
        news: '<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z" /></svg>',
        photo: '<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z" /></svg>',
        edit: '<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" /></svg>',
        plan: '<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" /></svg>'
      };
      const deptColors = {
        news: '#1e40af',
        photo: '#059669',
        edit: '#9333ea',
        plan: '#ea580c'
      };
      
      container.innerHTML = Object.entries(teamData.departments).map(([key, dept]) => `
        <div class="dept-item">
          <div class="dept-header">
            <div class="dept-icon" style="background-color: ${deptColors[key]};">
              ${deptIcons[key]}
            </div>
            <div>
              <div class="dept-name">${dept.name}</div>
              <div style="color: #666; font-size: 14px;">${dept.englishName}</div>
            </div>
          </div>
          <p style="margin-bottom: 15px; color: #555;">${dept.description}</p>
          <div style="font-size: 14px; color: #666;">
            <div><strong>部长：</strong>${dept.leader}</div>
            <div><strong>副部长：</strong>${dept.viceLeader}</div>
            <div><strong>成员：</strong>${dept.members}人</div>
          </div>
        </div>
      `).join('');
    }

    // 渲染优秀成员信息
    function renderMembers() {
      const container = document.getElementById('memberList');
      const memberColors = {
        blue: '#1e40af',
        green: '#059669',
        purple: '#9333ea',
        orange: '#ea580c'
      };
      
      container.innerHTML = Object.entries(teamData.members).map(([key, member]) => `
        <div class="member-item">
          <div class="member-avatar-mini" style="background-color: ${memberColors[member.color]};">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
            </svg>
          </div>
          <h4 style="font-size: 18px; margin-bottom: 5px;">${member.name}</h4>
          <p style="color: ${memberColors[member.color]}; font-weight: bold; margin-bottom: 10px;">${member.position}</p>
          <p style="color: #555; font-size: 14px; line-height: 1.4; margin-bottom: 10px;">${member.description}</p>
          <span style="background: ${memberColors[member.color]}; color: white; padding: 4px 8px; border-radius: 12px; font-size: 12px;">${member.tag}</span>
        </div>
      `).join('');
    }

    // 渲染团队数据
    function renderStats() {
      const container = document.getElementById('statsList');
      const stats = [
        { label: '团队成员', value: teamData.stats.teamMembers },
        { label: '新闻报道', value: teamData.stats.newsReports },
        { label: '获奖作品', value: teamData.stats.awards },
        { label: '年度历程', value: teamData.stats.years }
      ];
      
      container.innerHTML = stats.map(stat => `
        <div class="stat-item">
          <div class="stat-number">${stat.value}</div>
          <div style="color: #666; font-weight: bold;">${stat.label}</div>
        </div>
      `).join('');
    }

    // 编辑部门信息
    function openDeptModal() {
      // 加载当前数据到表单
      document.getElementById('news_leader').value = teamData.departments.news.leader;
      document.getElementById('news_vice_leader').value = teamData.departments.news.viceLeader;
      document.getElementById('news_members').value = teamData.departments.news.members;
      document.getElementById('news_desc').value = teamData.departments.news.description;
      
      document.getElementById('photo_leader').value = teamData.departments.photo.leader;
      document.getElementById('photo_vice_leader').value = teamData.departments.photo.viceLeader;
      document.getElementById('photo_members').value = teamData.departments.photo.members;
      document.getElementById('photo_desc').value = teamData.departments.photo.description;
      
      document.getElementById('edit_leader').value = teamData.departments.edit.leader;
      document.getElementById('edit_vice_leader').value = teamData.departments.edit.viceLeader;
      document.getElementById('edit_members').value = teamData.departments.edit.members;
      document.getElementById('edit_desc').value = teamData.departments.edit.description;
      
      document.getElementById('plan_leader').value = teamData.departments.plan.leader;
      document.getElementById('plan_vice_leader').value = teamData.departments.plan.viceLeader;
      document.getElementById('plan_members').value = teamData.departments.plan.members;
      document.getElementById('plan_desc').value = teamData.departments.plan.description;
      
      document.getElementById('deptModal').style.display = 'block';
    }

    function closeDeptModal() {
      document.getElementById('deptModal').style.display = 'none';
    }

    // 编辑优秀成员信息
    function openMemberModal() {
      // 加载当前数据到表单
      document.getElementById('member1_name').value = teamData.members.member1.name;
      document.getElementById('member1_position').value = teamData.members.member1.position;
      document.getElementById('member1_desc').value = teamData.members.member1.description;
      document.getElementById('member1_tag').value = teamData.members.member1.tag;
      
      document.getElementById('member2_name').value = teamData.members.member2.name;
      document.getElementById('member2_position').value = teamData.members.member2.position;
      document.getElementById('member2_desc').value = teamData.members.member2.description;
      document.getElementById('member2_tag').value = teamData.members.member2.tag;
      
      document.getElementById('member3_name').value = teamData.members.member3.name;
      document.getElementById('member3_position').value = teamData.members.member3.position;
      document.getElementById('member3_desc').value = teamData.members.member3.description;
      document.getElementById('member3_tag').value = teamData.members.member3.tag;
      
      document.getElementById('member4_name').value = teamData.members.member4.name;
      document.getElementById('member4_position').value = teamData.members.member4.position;
      document.getElementById('member4_desc').value = teamData.members.member4.description;
      document.getElementById('member4_tag').value = teamData.members.member4.tag;
      
      document.getElementById('memberModal').style.display = 'block';
    }

    function closeMemberModal() {
      document.getElementById('memberModal').style.display = 'none';
    }

    // 编辑团队数据
    function openStatsModal() {
      document.getElementById('team_members').value = teamData.stats.teamMembers;
      document.getElementById('news_reports').value = teamData.stats.newsReports;
      document.getElementById('awards').value = teamData.stats.awards;
      document.getElementById('years').value = teamData.stats.years;
      
      document.getElementById('statsModal').style.display = 'block';
    }

    function closeStatsModal() {
      document.getElementById('statsModal').style.display = 'none';
    }

    // 保存部门信息
    document.getElementById('deptForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      // 更新数据
      teamData.departments.news.leader = document.getElementById('news_leader').value;
      teamData.departments.news.viceLeader = document.getElementById('news_vice_leader').value;
      teamData.departments.news.members = parseInt(document.getElementById('news_members').value);
      teamData.departments.news.description = document.getElementById('news_desc').value;
      
      teamData.departments.photo.leader = document.getElementById('photo_leader').value;
      teamData.departments.photo.viceLeader = document.getElementById('photo_vice_leader').value;
      teamData.departments.photo.members = parseInt(document.getElementById('photo_members').value);
      teamData.departments.photo.description = document.getElementById('photo_desc').value;
      
      teamData.departments.edit.leader = document.getElementById('edit_leader').value;
      teamData.departments.edit.viceLeader = document.getElementById('edit_vice_leader').value;
      teamData.departments.edit.members = parseInt(document.getElementById('edit_members').value);
      teamData.departments.edit.description = document.getElementById('edit_desc').value;
      
      teamData.departments.plan.leader = document.getElementById('plan_leader').value;
      teamData.departments.plan.viceLeader = document.getElementById('plan_vice_leader').value;
      teamData.departments.plan.members = parseInt(document.getElementById('plan_members').value);
      teamData.departments.plan.description = document.getElementById('plan_desc').value;
      
      // 更新总成员数
      teamData.stats.teamMembers = teamData.departments.news.members + teamData.departments.photo.members + teamData.departments.edit.members + teamData.departments.plan.members;
      
      renderTeamData();
      closeDeptModal();
      alert('部门信息已更新！');
    });

    // 保存优秀成员信息
    document.getElementById('memberForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      teamData.members.member1.name = document.getElementById('member1_name').value;
      teamData.members.member1.position = document.getElementById('member1_position').value;
      teamData.members.member1.description = document.getElementById('member1_desc').value;
      teamData.members.member1.tag = document.getElementById('member1_tag').value;
      
      teamData.members.member2.name = document.getElementById('member2_name').value;
      teamData.members.member2.position = document.getElementById('member2_position').value;
      teamData.members.member2.description = document.getElementById('member2_desc').value;
      teamData.members.member2.tag = document.getElementById('member2_tag').value;
      
      teamData.members.member3.name = document.getElementById('member3_name').value;
      teamData.members.member3.position = document.getElementById('member3_position').value;
      teamData.members.member3.description = document.getElementById('member3_desc').value;
      teamData.members.member3.tag = document.getElementById('member3_tag').value;
      
      teamData.members.member4.name = document.getElementById('member4_name').value;
      teamData.members.member4.position = document.getElementById('member4_position').value;
      teamData.members.member4.description = document.getElementById('member4_desc').value;
      teamData.members.member4.tag = document.getElementById('member4_tag').value;
      
      renderTeamData();
      closeMemberModal();
      alert('优秀成员信息已更新！');
    });

    // 保存团队数据
    document.getElementById('statsForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      teamData.stats.teamMembers = parseInt(document.getElementById('team_members').value);
      teamData.stats.newsReports = document.getElementById('news_reports').value;
      teamData.stats.awards = document.getElementById('awards').value;
      teamData.stats.years = parseInt(document.getElementById('years').value);
      
      renderTeamData();
      closeStatsModal();
      alert('团队数据已更新！');
    });

    // 检查登录状态
    function checkLoginStatus() {
      const loginStatus = localStorage.getItem('admin_logged_in');
      const loginTime = localStorage.getItem('admin_login_time');
      const username = localStorage.getItem('admin_username');
      
      if (loginStatus !== 'true' || !loginTime) {
        // 未登录，跳转到登录页面
        window.location.href = '/admin/login.html';
        return false;
      }
      
      const now = new Date().getTime();
      const loginTimeMs = parseInt(loginTime);
      
      // 检查登录是否过期（24小时）
      if (now - loginTimeMs > 24 * 60 * 60 * 1000) {
        // 登录过期，清除状态并跳转到登录页面
        localStorage.removeItem('admin_logged_in');
        localStorage.removeItem('admin_login_time');
        localStorage.removeItem('admin_username');
        window.location.href = '/admin/login.html';
        return false;
      }
      
      // 显示欢迎信息
      if (username) {
        document.getElementById('welcomeText').textContent = `欢迎回来，${username}`;
      }
      
      return true;
    }

    // 退出登录
    function logout() {
      if (confirm('确定要退出登录吗？')) {
        localStorage.removeItem('admin_logged_in');
        localStorage.removeItem('admin_login_time');
        localStorage.removeItem('admin_username');
        window.location.href = '/admin/login.html';
      }
    }

    // 页面加载时初始化
    document.addEventListener('DOMContentLoaded', function() {
      // 首先检查登录状态
      if (!checkLoginStatus()) {
        return; // 如果未登录，直接返回（页面会跳转）
      }
      
      // 登录验证通过，初始化页面
      loadExistingArticles();
      renderTeamData();
    });
  </script>
</body>
</html>